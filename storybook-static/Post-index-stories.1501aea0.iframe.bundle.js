"use strict";(self.webpackChunknext_enterprise=self.webpackChunknext_enterprise||[]).push([[142],{"./components/Post/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>index_stories});var react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),regenerator=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),next_link=__webpack_require__("./node_modules/next/link.js"),link_default=__webpack_require__.n(next_link),navigation=__webpack_require__("./node_modules/next/navigation.js"),lib=__webpack_require__("./node_modules/react-markdown/lib/index.js"),rehype_katex_lib=__webpack_require__("./node_modules/rehype-katex/lib/index.js"),rehype_stringify_lib=__webpack_require__("./node_modules/rehype-stringify/lib/index.js"),remark_math_lib=__webpack_require__("./node_modules/remark-math/lib/index.js"),remark_parse_lib=__webpack_require__("./node_modules/remark-parse/lib/index.js"),remark_rehype_lib=__webpack_require__("./node_modules/remark-rehype/lib/index.js"),PostEditor=__webpack_require__("./components/PostEditor/index.tsx"),katexRegex=__webpack_require__("./lib/katexRegex/index.ts"),__jsx=react.createElement,Post=function Post(_ref){var votePost,post=_ref.post,_votePost=_ref.votePost,_useState=(0,react.useState)(!1),showThread=_useState[0],setShowThread=_useState[1],router=(0,navigation.useRouter)();return votePost=_votePost||function votePost(){},__jsx(react.Fragment,null,__jsx("div",{className:"flex w-fit flex-col items-stretch bg-secondary-100 shadow-2xl"},__jsx("div",{className:"flex flex-row gap-4 p-2"},__jsx(link_default(),{href:"/in/user/".concat(post.author._id),className:"group"},__jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"w-12"},__jsx("circle",{cx:"12",cy:"12",r:"10",className:"fill-primary-600"}),__jsx("path",{className:"fill-primary-100",d:"M3.66 17.52A5 5 0 0 1 8 15h8a5 5 0 0 1 4.34 2.52 10 10 0 0 1-16.68 0zM12 13a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"})),__jsx("div",{className:"absolute z-10 scale-y-0 bg-secondary-200 p-2 shadow-2xl duration-200 group-hover:scale-y-100"},__jsx("h2",null,post.author.name),__jsx("h3",{className:"mb-4 text-sm"},"<",post.author.email,">"))),__jsx("div",{className:"flex flex-col items-start text-left"},__jsx("h2",{className:"font-bold"},post.author.name),__jsx("h3",{className:"text-sm text-secondary-700"},new Date(post.posted).toLocaleString("pl-PL",{timeZone:"UTC"})," UTC"))),__jsx("div",{className:"prose m-8 bg-secondary-200 p-4"},__jsx(lib.U,{remarkPlugins:[remark_parse_lib.Z,remark_math_lib.Z,remark_rehype_lib.Z,rehype_katex_lib.Z,rehype_stringify_lib.Z]},post.content)),__jsx("div",{className:"flex flex-row flex-nowrap gap-4 p-4"},__jsx("div",{className:"cursor-pointer font-semibold text-green-300 hover:font-bold hover:text-green-500",onClick:function onClick(){votePost(post._id,!0)}},"+ ",post.up),__jsx("div",{className:"cursor-pointer font-semibold text-red-300 hover:font-bold hover:text-red-500",onClick:function onClick(){votePost(post._id,!1)}},"- ",post.down),__jsx("div",{className:"font-semibold text-primary-300 hover:font-bold hover:text-primary-600"},__jsx("svg",{onClick:function onClick(){setShowThread((function(q){return!q}))},height:"800px",width:"800px",version:"1.1",className:"h-8 w-8 cursor-pointer",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 29.338 29.338"},__jsx("g",null,__jsx("path",{className:"fill-primary-600",d:"M27.184,1.605H2.156C0.967,1.605,0,2.572,0,3.76v17.572c0,1.188,0.967,2.155,2.156,2.155h13.543 l5.057,3.777c0.414,0.31,0.842,0.468,1.268,0.468c0.789,0,1.639-0.602,1.637-1.923v-2.322h3.523c1.188,0,2.154-0.967,2.154-2.155 V3.76C29.338,2.572,28.371,1.605,27.184,1.605z M27.34,21.332c0,0.085-0.068,0.155-0.154,0.155h-5.523v3.955l-5.297-3.956H2.156 c-0.086,0-0.154-0.07-0.154-0.155V3.759c0-0.085,0.068-0.155,0.154-0.155v0.001h25.029c0.086,0,0.154,0.07,0.154,0.155 L27.34,21.332L27.34,21.332z M5.505,10.792h4.334v4.333H5.505C5.505,15.125,5.505,10.792,5.505,10.792z M12.505,10.792h4.334v4.333 h-4.334V10.792z M19.505,10.792h4.334v4.333h-4.334V10.792z"}))),post.comments.length))),showThread?__jsx(react.Fragment,null,post.comments.map((function(comment){return __jsx(react.Fragment,null,__jsx("div",{className:"ml-32"},__jsx("div",{className:"bg-secondary-100 p-4 shadow-2xl"},__jsx("div",{className:"flex flex-row gap-4 p-2"},__jsx(link_default(),{href:"/in/user/".concat(comment.author._id),className:"group"},__jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"w-12"},__jsx("circle",{cx:"12",cy:"12",r:"10",className:"fill-primary-600"}),__jsx("path",{className:"fill-primary-100",d:"M3.66 17.52A5 5 0 0 1 8 15h8a5 5 0 0 1 4.34 2.52 10 10 0 0 1-16.68 0zM12 13a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"})),__jsx("div",{className:"absolute z-10 scale-y-0 bg-secondary-200 p-2 shadow-2xl duration-200 group-hover:scale-y-100"},__jsx("h2",null,comment.author.name),__jsx("h3",{className:"mb-4 text-sm"},"<",comment.author.email,">"))),__jsx("div",{className:"flex flex-col items-start text-left"},__jsx("h2",{className:"font-bold"},comment.author.name),__jsx("h3",{className:"text-sm text-secondary-700"},new Date(comment.posted).toLocaleString("pl-PL",{timeZone:"UTC"})," UTC"))),__jsx("div",{className:"prose m-8 bg-secondary-200 p-4"},__jsx(lib.U,{remarkPlugins:[remark_parse_lib.Z,remark_math_lib.Z,remark_rehype_lib.Z,rehype_katex_lib.Z,rehype_stringify_lib.Z]},comment.content)))))})),__jsx("div",{className:"bg-secondary-100 p-2 shadow-2xl"},__jsx("h2",{className:"m-2 text-xl"},"Write a comment"),__jsx(PostEditor.v,{submit:function(){var _ref2=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(content,setalert){return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,fetch("/api/comment",{method:"POST",body:JSON.stringify({post:post._id,content:(0,katexRegex.l)(content)})});case 2:_context.sent.ok?(router.refresh(),window.location.reload()):setalert({message:"Something went wrong",type:"error"});case 4:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2){return _ref2.apply(this,arguments)}}()}))):null)};try{Post.displayName="Post",Post.__docgenInfo={description:"",displayName:"Post",props:{post:{defaultValue:null,description:"",name:"post",required:!0,type:{name:"PostAuthorID"}},votePost:{defaultValue:null,description:"",name:"votePost",required:!0,type:{name:"votePostCallback | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/Post/index.tsx#Post"]={docgenInfo:Post.__docgenInfo,name:"Post",path:"components/Post/index.tsx#Post"})}catch(__react_docgen_typescript_loader_error){}var index_stories_jsx=react.createElement,meta={title:"Post",component:Post,args:{post:{_id:"876587658765876587658765",author:{email:"user@email.com",name:"Random user",hash:"x",added:0,type:"user",_id:"876587658765876587658765"},posted:Date.now()-3600,content:"Good morning everyone",up:0,down:4,comments:[]}}},Default={render:function render(args){return index_stories_jsx(Post,args)}};const index_stories=meta;Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{\n  render: args => <Post {...args} />\n}",...Default.parameters?.docs?.source}}};const __namedExportsOrder=["Default"]},"./components/Alert/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{b:()=>Alert});var __jsx=__webpack_require__("./node_modules/next/dist/compiled/react/index.js").createElement,Alert=function Alert(_ref){var children=_ref.children;switch(_ref.type){case"error":return __jsx("div",{role:"alert",title:"alert",className:" flex flex-row flex-nowrap items-center border-l-8 border-vividred-600 bg-vividred-300 p-4 text-vividred-800"},__jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:" mr-4 w-8"},__jsx("circle",{cx:"12",cy:"12",r:"10",className:"fill-vividred-600"}),__jsx("path",{className:"fill-vividred-300",d:"M13.41 12l2.83 2.83a1 1 0 0 1-1.41 1.41L12 13.41l-2.83 2.83a1 1 0 1 1-1.41-1.41L10.59 12 7.76 9.17a1 1 0 0 1 1.41-1.41L12 10.59l2.83-2.83a1 1 0 0 1 1.41 1.41L13.41 12z"})),__jsx("div",{className:"text-xl font-bold"},children));case"warning":return __jsx("div",{role:"alert",title:"alert",className:" flex flex-row flex-nowrap items-center border-l-8 border-vividyellow-600 bg-vividyellow-300 p-4 text-vividyellow-800"},__jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"mr-4 w-8"},__jsx("path",{className:"fill-vividyellow-600",d:"M12 2a10 10 0 1 1 0 20 10 10 0 0 1 0-20z"}),__jsx("path",{className:"fill-vividyellow-300",d:"M12 18a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm1-5.9c-.13 1.2-1.88 1.2-2 0l-.5-5a1 1 0 0 1 1-1.1h1a1 1 0 0 1 1 1.1l-.5 5z"})),__jsx("div",{className:"text-xl font-bold"},children));case"success":return __jsx("div",{role:"alert",title:"alert",className:" flex flex-row flex-nowrap items-center border-l-8 border-teal-600 bg-teal-300 p-4 text-teal-800"},__jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"mr-4 w-8"},__jsx("circle",{cx:"12",cy:"12",r:"10",className:"fill-teal-600"}),__jsx("path",{className:"fill-teal-300",d:"M10 14.59l6.3-6.3a1 1 0 0 1 1.4 1.42l-7 7a1 1 0 0 1-1.4 0l-3-3a1 1 0 0 1 1.4-1.42l2.3 2.3z"})),__jsx("div",{className:"text-xl font-bold"},children));case"loading":return __jsx("div",{role:"alert",title:"alert",className:" flex flex-row flex-nowrap items-center border-l-8 border-teal-600 bg-teal-300 p-4 text-teal-800"},__jsx("div",{className:" mr-4 h-8 w-8 animate-spin rounded-full bg-teal-600"},__jsx("div",{className:" ml-2 mr-4 mt-2 h-4 w-4 rounded-full bg-teal-300"}),__jsx("div",{className:"ml-3.5 h-2 w-1 bg-teal-300"})),__jsx("div",{className:"text-xl font-bold"},children));default:return __jsx("div",{role:"alert",title:"alert",className:" flex flex-row flex-nowrap items-center border-l-8 border-lightblue-600 bg-lightblue-300 p-4 text-lightblue-800"},__jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:" mr-4 w-8"},__jsx("path",{className:"fill-lightblue-600",d:"M12 2a10 10 0 1 1 0 20 10 10 0 0 1 0-20z"}),__jsx("path",{className:"fill-lightblue-300",d:"M11 12a1 1 0 0 1 0-2h2a1 1 0 0 1 .96 1.27L12.33 17H13a1 1 0 0 1 0 2h-2a1 1 0 0 1-.96-1.27L11.67 12H11zm2-4a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"})),__jsx("div",{className:"text-xl font-bold"},children))}};try{Alert.displayName="Alert",Alert.__docgenInfo={description:"",displayName:"Alert",props:{type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"enum",value:[{value:'"error"'},{value:'"info"'},{value:'"warning"'},{value:'"success"'},{value:'"loading"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/Alert/index.tsx#Alert"]={docgenInfo:Alert.__docgenInfo,name:"Alert",path:"components/Alert/index.tsx#Alert"})}catch(__react_docgen_typescript_loader_error){}},"./components/PostEditor/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{v:()=>PostEditor});var asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),regenerator=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),Alert=__webpack_require__("./components/Alert/index.tsx"),esm=__webpack_require__("./node_modules/@uiw/react-md-editor/esm/index.js"),__jsx=(__webpack_require__("./node_modules/katex/dist/katex.css"),react.createElement),Editor=function Editor(_ref){var value=_ref.value,setValue=_ref.setValue;return __jsx("div",{className:"container"},__jsx(esm.ZP,{"data-color-mode":"light",value,height:300,onChange:function onChange(val){setValue(val||"")}}))};Editor.displayName="Editor";try{Editor.displayName="Editor",Editor.__docgenInfo={description:"",displayName:"Editor",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},setValue:{defaultValue:null,description:"",name:"setValue",required:!0,type:{name:"Dispatch<SetStateAction<string>>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/Editor/index.tsx#Editor"]={docgenInfo:Editor.__docgenInfo,name:"Editor",path:"components/Editor/index.tsx#Editor"})}catch(__react_docgen_typescript_loader_error){}var console=__webpack_require__("./node_modules/console-browserify/index.js"),FileUpload_jsx=react.createElement;function FileUploader(props){var onImageFileChange=function(){var _ref=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(e){var fileInput,file,formData,res,data;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if((fileInput=e.target).files){_context.next=4;break}return console.warn("no file was chosen"),_context.abrupt("return");case 4:if(fileInput.files&&0!==fileInput.files.length){_context.next=7;break}return console.warn("files list is empty"),_context.abrupt("return");case 7:return file=fileInput.files[0],(formData=new FormData).append("file",file),_context.prev=10,_context.next=13,fetch("/api/upload",{method:"POST",body:formData});case 13:if((res=_context.sent).ok){_context.next=17;break}return console.error("something went wrong, check your console."),_context.abrupt("return");case 17:return _context.next=19,res.json();case 19:if(data=_context.sent,!props.uploadedCallback){_context.next=23;break}return _context.next=23,props.uploadedCallback(data.fileUrl);case 23:props.refresh&&window.location.reload(),_context.next=29;break;case 26:_context.prev=26,_context.t0=_context.catch(10),console.error("something went wrong, check your console.");case 29:e.target.type="text",e.target.type="file";case 31:case"end":return _context.stop()}}),_callee,null,[[10,26]])})));return function onImageFileChange(_x){return _ref.apply(this,arguments)}}();return FileUpload_jsx("input",{type:"file",onChange:onImageFileChange,className:"rounded-md bg-secondary-800 p-8 text-xl text-white shadow-inner shadow-secondary-500"})}FileUploader.displayName="FileUploader";try{FileUpload.displayName="FileUpload",FileUpload.__docgenInfo={description:"",displayName:"FileUpload",props:{uploadedCallback:{defaultValue:null,description:"",name:"uploadedCallback",required:!1,type:{name:"((filename: string) => Promise<void>) | undefined"}},refresh:{defaultValue:null,description:"",name:"refresh",required:!1,type:{name:"boolean | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/FileUpload/index.tsx#FileUpload"]={docgenInfo:FileUpload.__docgenInfo,name:"FileUpload",path:"components/FileUpload/index.tsx#FileUpload"})}catch(__react_docgen_typescript_loader_error){}var katexRegex=__webpack_require__("./lib/katexRegex/index.ts");function submit_submit(_x,_x2){return _submit.apply(this,arguments)}function _submit(){return(_submit=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(post,setalert){var npost;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return npost=(0,katexRegex.l)(post),_context.next=3,fetch("/api/post",{method:"POST",body:JSON.stringify({content:npost})});case 3:_context.sent.ok?window.location.reload():setalert({type:"error",message:"Something has gone wrong"});case 5:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}var PostEditor_jsx=react.createElement,PostEditor=function PostEditor(props){var _useState=(0,react.useState)(""),value=_useState[0],setvalue=_useState[1],_useState2=(0,react.useState)({type:null,message:""}),alert=_useState2[0],setalert=_useState2[1];return PostEditor_jsx("div",{className:"flex max-w-[1000px] flex-col items-end gap-4 px-4"},PostEditor_jsx("div",{className:"flex flex-col items-start gap-2 self-start"},PostEditor_jsx("span",null,"Upload an image: "),PostEditor_jsx(FileUploader,{uploadedCallback:function(){var _ref=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(filename){return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:setvalue((function(v){return v+"![".concat(filename,"](/api/image/").concat(filename,")")}));case 1:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}()})),PostEditor_jsx(Editor,{value,setValue:setvalue}),alert.type?PostEditor_jsx(Alert.b,{type:alert.type},alert.message):null,PostEditor_jsx("div",{className:"m-8 flex gap-4 self-end"},PostEditor_jsx("button",{className:"box-border rounded-md border-2 border-primary-500 p-2 text-primary-500",onClick:function onClick(){setvalue("")}},"Cancel"),PostEditor_jsx("button",{className:"rounded-md bg-primary-500 p-2 text-white",onClick:(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee2(){return regenerator_default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(value){_context2.next=2;break}return _context2.abrupt("return");case 2:if(setalert({type:"loading",message:"Please wait..."}),null==props||!props.submit){_context2.next=8;break}return _context2.next=6,props.submit(value,setalert);case 6:_context2.next=10;break;case 8:return _context2.next=10,submit_submit(value,setalert);case 10:case"end":return _context2.stop()}}),_callee2)})))},"Submit")))};PostEditor.displayName="PostEditor";try{PostEditor.displayName="PostEditor",PostEditor.__docgenInfo={description:"",displayName:"PostEditor",props:{submit:{defaultValue:null,description:"",name:"submit",required:!1,type:{name:"((post: string, setalert: Dispatch<SetStateAction<alertMessage>>) => Promise<void>) | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/PostEditor/index.tsx#PostEditor"]={docgenInfo:PostEditor.__docgenInfo,name:"PostEditor",path:"components/PostEditor/index.tsx#PostEditor"})}catch(__react_docgen_typescript_loader_error){}},"./lib/katexRegex/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function katexRegex(content){return content.replace(/```KaTeX(([^\n\r]|\n|\r)*?)```/g,"$$$ $1 $$$")}__webpack_require__.d(__webpack_exports__,{l:()=>katexRegex})}}]);